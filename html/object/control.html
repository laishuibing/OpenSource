<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,initial-scale=1.0,width=device-width" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <link rel="stylesheet" href="../../css/aui.css">

    <style>
        body {
            background-color: #f1f1f1;
        } //设置白色背景
        // 设置列表和列表项的统一
        body,
        ul,
        li {
            margin: 0px;
            padding: 0px;
        }

        ul {
            list-style: none;
            background-color: white;
            margin-top: 30px;
            border-top: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
        }

        ul li {
            margin-left: 5%;
            border-bottom: 1px solid #ddd;
        }

        ul li {
            padding-top: 10px;
            padding-bottom: 10px;
        }

        ul li :last-child {
            border-bottom: 0px;
        }

        ul li .ios7CBox:after {
            width: 18px;
            height: 18px;
            top: 3px;
        }

        ul li .ios7CBox {
            display: table-cell;
            vertical-align: middle;
            height: 24px;
            width: 40px;
        }

        .gos_rightBlock {
            float: right;
            margin-right: 5%;
        }

        .gos_readonly {
            color: darkGray;
        }

        .gos_slideCellBottom {
            margin: 3px 0;
        }

        .gos_slideMin {
            width: 12%;
            text-align: center;
            float: left;
        }

        .gos_slideDiv {
            width: 73%;
            float: left;
            padding-top: 8px;
            margin: 0;
            position: relative;
        }

        .gos_slide {
            display: block;
            width: 130%;
            position: absolute;
            left: 0;
            top: 0;
        }

        .gos_slideMax {
            float: left;
            width: 12%;
            text-align: center;
            padding: 0;
            margin: 0;
        }

        .gos_extendTitle {
            display: inline-block;
            height: 18px;
            position: absolute;
            width: 30%;
            top: 0;
            bottom: 0;
            margin: auto;
        }

        .gos_extendLi {
            position: relative;
            padding: 10px 0px;
        }

        .gos_extend {
            display: table-cell;
            *display: inline-block;
            overflow: hidden;
            font-size: 14px;
            line-height: 24px;
            padding: 2px;
            margin-left: 35%;
            margin-top: 0px;
            margin-bottom: 0px;
            margin-right: 0px;
            /*background-color: blue;*/
            width: 60%;
            height: 24px;
        }

        textarea {
            outline: 0 none;
            /*border-color: rgba(82, 168, 236, 0.8);
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1), 0 0 8px rgba(82, 168, 236, 0.6);*/
            /*border-color: rgba(0, 0, 0, 1);*/
            box-shadow: inset 0 1px 1px rgba(0, 0, 0, 1), 0 0 1px rgba(0, 0, 0, 1);
        }
    </style>
</head>

<body>

    <ul>
        <li>
            <span>key</span>
            <span class="gos_rightBlock gos_keyBlock">
              <input class="ios7CBox gos_key" type="checkbox">
          </span>
        </li>
        <li>
            <span class="gos_readonly">led</span>
            <span class="gos_rightBlock gos_ledBlock">
              <input class="ios7CBox gos_led" type="checkbox">
          </span>
        </li>
        <li>
            <span class="gos_readonly">ADC</span>
            <span class="gos_rightBlock gos_readonly gos_ADC">0

      </li>
  </ul>

  <div class="aui-btn aui-btn-block">默认按钮(default)</div>
  <div class="aui-btn aui-btn-info"><span class="aui-iconfont aui-icon-edit"></span>图标按钮</div>

</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/jquery.js"></script>
<script type="text/javascript" src="../../script/jquery.min.js"></script>
<script type="text/javascript" src="../../script/base.js"></script>
<script type="text/javascript" src="../../script/fastclick.js"></script>
<script type="text/javascript" src="../../script/Base64.js"></script>
<script type="text/javascript" src="../../script/slide/rangeslider.min.js"></script>
<script type="text/javascript">

// 数据点枚举标识
var dataPoint = {
   GosDeviceWrite_key: 0,
   GosDeviceRead_led: 1,
   GosDeviceRead_ADC: 2,
}
  var device, gizWifiDevice;

	apiready = function(){
    api.addEventListener({ name : 'viewappear'}, fnAppear);
  addButtonClickEvent("gos_keyBlock");
        device = api.pageParam.pageParam;
        gizWifiDevice = api.require('gizWifiDevice');
        var title = device.productName;
        if (device.alias) {
            title = device.alias;
        }
        api.execScript({
            name: 'win_control',
            script: 'fnSetNavigationTitle({"name": ".controlTitle", "value": "' + title + '"})'
        });
		//document.body.innerHTML = device.mac;
	}
function fnAppear(){}

// 写数据点数据
function write(dp, value){
    var data;
    switch(dp)
    {
        case dataPoint.GosDeviceWrite_key:
            data = {"key": value};
            break;
    }

    console.log("下发控制指令： data = " + JSON.stringify(data) + "device = " + JSON.stringify(device) + ", device.device = " + JSON.stringify(device.device));
    gizWifiDevice.write({
        device: device,
        sn: 0,
        data: data
    }, function(ret, err){
        console.log('下发控制指令回调 ret = ' + JSON.stringify(ret) + ', err = ' + JSON.stringify(err));
    });
}

function updateButtonAttr(buttonClsName, isChecked)
{
    // 下发布尔可写值控制指令位置
    console.log("buttonClsName = " + buttonClsName + ", isChecked = " + isChecked);
    if (buttonClsName == ".gos_key") {
        console.log('buttonClsName == ".gos_key"');
        write(dataPoint.GosDeviceWrite_key, isChecked);
    }
}

// 按钮被点击调用的方法
function ios7CBoxDidClick( el, blockClsName){
     var buttonClsName = "." + blockClsName.replace("Block", "");

     // 渲染颜色
     if( $api.hasCls(el.querySelector( buttonClsName ), "checked") ){
         updateButtonAttr(buttonClsName, false);
         $api.removeCls(el.querySelector( buttonClsName ), "checked");
     }else{
         updateButtonAttr(buttonClsName, true);
         $api.addCls(el.querySelector( buttonClsName ), "checked");
     }

}

// 根据给定的类名获取指定的dom元素
function getElByClsName(clsName)
{
    var doms = document.getElementsByClassName(clsName);
    return doms[0];
}
// 设置按钮点击事件
 function addButtonClickEvent(blockClsName)
 {
     var button = getElByClsName(blockClsName);
     //FastClick.attach(button);
     button.addEventListener("click", function(event) {
         ios7CBoxDidClick(button, blockClsName);
     }, false);
 }

    function fnUnsubscribe() {
        var gizWifiDevice = api.require("gizWifiDevice");
        gizWifiDevice.setSubscribe({device: device, subscribed: false}, function(ret, err) {});
    }
</script>
</html>
